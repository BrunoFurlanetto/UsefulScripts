#!/usr/bin/env bash
echo "üöÄ Git post-checkout hook triggered ‚Äî syncing branch database..."

# Detect repo root based on this hook‚Äôs location
REPO_ROOT="$(git rev-parse --show-toplevel)"
cd "$REPO_ROOT"

# Activate virtualenv
VENV_DIR="$REPO_ROOT/.venv"
if [ -d "$VENV_DIR" ]; then
    echo "üêç Activating virtualenv at $VENV_DIR..."
    source "$VENV_DIR/Scripts/activate"
else
    echo "‚ö†Ô∏è  No virtualenv found at $VENV_DIR ‚Äî using system Python."
fi

# Run the correct script path
PY_SCRIPT="$REPO_ROOT/SyncBranchDB/SyncBranchDB/main.py"

if [ -f "$PY_SCRIPT" ]; then
    python "$PY_SCRIPT"
else
    echo "‚ùå Script not found at $PY_SCRIPT"
fi

echo "‚úÖ post-checkout finished."
